import torch
from torchvision.models import AlexNet
import torch.nn as nn
from torchviz import make_dot

blocks=nn.Transformer(d_model=768,nhead=12, num_encoder_layers=1,num_decoder_layers=0)
print(blocks)
x=torch.rand(1,197,768)




x=torch.rand(2,197,768)
Single_Encoder = nn.TransformerEncoderLayer(d_model=768, nhead=8,batch_first=True,norm_first=True)#在Vit中的norm需要位于atten和FF之前
Encoders= nn.TransformerEncoder(Single_Encoder,num_layers=1,norm=None)#构建多个连在一起的Encoder
                                                                      #nomrm 就是在末尾加一个normlization
x=Encoders(x)
print(x.shape)
print(Single_Encoder)
# out=Single_Encoder(x)
# g = make_dot(out)
# g.render('espnet_model', view=True)
Atten=nn.MultiheadAttention